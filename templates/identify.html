<html>
<script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
        <script src="https://unpkg.com/vue-router@3.5.3/dist/vue-router.js"></script>
        <script src="https://unpkg.com/vuex@2.0.0/dist/vuex.js"></script>
        <!-- Bootstrap CSS -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
        <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
        <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900" rel="stylesheet">
        <link href="https://cdn.jsdelivr.net/npm/@mdi/font@6.x/css/materialdesignicons.min.css" rel="stylesheet">
        <link href="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.min.css" rel="stylesheet">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Sofia">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Sofia&effect=neon|outline|emboss|shadow-multiple">
        <!--<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">-->
        <script src="https://cdn.jsdelivr.net/npm/vuetify@2.0.0/dist/vuetify.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/2.0.2/anime.min.js"></script>
        
<style>
  html {
  scroll-behavior: smooth;
}
        .heading{
font-family:Roboto;
color: rgb(3, 6, 43);
font-size: 45px;
}

.button {
  background-color: #040a46; /* Green */
  border: none;
  color: white;
  padding: 10px 22px;
  text-align: center;
  text-decoration: none;
  display: inline-block;
  font-size: 16px;
  margin: 4px 2px;
  transition-duration: 0.4s;
  cursor: pointer;
  border-radius: 4px;
}

.button1 {
  background-color: #040a46; 
  color: white; 
  border: 2px solid #040a46;
  margin-left: 38em;
  
  border-radius: 4px;
}

.button1:hover {
  background-color: white;
  color: #040a46;
  
}
.custom-file-upload{
    color:#050d38;
    
    margin-left: 37em;
}

.custom-song-upload{
    color:#050d38;
    
    margin-left: 33em;
}
.fade-in-text {
  font-family: Arial;
  font-size: 20px;
  animation: fadeIn 5s;
  -webkit-animation: fadeIn 5s;
  -moz-animation: fadeIn 5s;
  -o-animation: fadeIn 5s;
  -ms-animation: fadeIn 5s;
}

@keyframes fadeIn {
  0% { opacity: 0; }
  100% { opacity: 1; }
}

@-moz-keyframes fadeIn {
  0% { opacity: 0; }
  100% { opacity: 1; }
}

@-webkit-keyframes fadeIn {
  0% { opacity: 0; }
  100% { opacity: 1; }
}

@-o-keyframes fadeIn {
  0% { opacity: 0; }
  100% { opacity: 1; }
}

@-ms-keyframes fadeIn {
  0% { opacity: 0; }
  100% { opacity: 1; }
}

</style>
        <div id="app">
    <v-app id="inspire">
        
      <v-bottom-navigation
        v-model="value"
        :background-color="color"
        dark>
        
        <v-btn>
      <span style=" font-family:'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif;">Raga Identification And Song Generator</span>
    </v-btn>
    
    </v-bottom-navigation>
    <v-stepper alt-labels>
      <v-stepper-header>
        <v-stepper-step step="1">
          Choose A Song
        </v-stepper-step>

        <v-divider></v-divider>

        <v-stepper-step step="2">
          Predict
        </v-stepper-step>

        <v-divider></v-divider>

        <v-stepper-step step="3">
          Raga & Notes Are Generated
        </v-stepper-step>
      </v-stepper-header>
    </v-stepper>
    <h1 class="heading" align ="center" > Select A Song</h1>
    
    <label class="custom-file-upload" >
        <input type="file"  @change="fileInput" v:bind="f" accept=".wav"/>
    </label>

    <audio controls v-show="filei" :src="file1" class="custom-song-upload" autoplay >
     
      Your browser does not support the audio element.
      </audio>

    <v-sparkline
      :value="value"
      :gradient="gradient"
      :smooth="radius || false"
      :padding="padding"
      :line-width="width"
      :stroke-linecap="lineCap"
      :gradient-direction="gradientDirection"
      :fill="fill"
      :type="type"
      :auto-line-width="autoLineWidth"
      :auto-draw-duration=2000
      auto-draw
    ></v-sparkline>

    <br><br><br><br>
    <br><br>
  <div id="divModel">
    <v-stepper alt-labels color="green accent-3">
      <v-stepper-header>
        <v-stepper-step step="1" complete >
          Choose A Song
        </v-stepper-step>

        <v-divider></v-divider>

        <v-stepper-step complete step="2">
          Predict
        </v-stepper-step>

        <v-divider></v-divider>

        <v-stepper-step step="3">
          Raga & Notes Are Generated
        </v-stepper-step>
      </v-stepper-header>
    </v-stepper>
<h3 class="heading" align ="center" > Now let's predict!!</h3>
  <img style="margin-left: 33em; " width="300" height="220" src="static/music.gif" >
  <div class="fade-in-text">
    <h5 align="center">Fourier Tranform Done <v-icon medium color="green darken-2">mdi-check-all</v-icon></h5> 
  </div>
  <div class="fade-in-text">
    <h5 align="center">Notes converted Done <v-icon medium color="green darken-2">mdi-check-all</v-icon></h5>
  </div>
  <div class="fade-in-text">
    <h5 align="center">Raga Predicted <v-icon medium color="green darken-2">mdi-check-all</v-icon></h5>
  </div>
  <button v-on:click="next" v-show="shbutton" class="button button1" >Check Results</button>
    </div>
    <br><br>
    <div id="Predict">
      <v-bottom-navigation
      v-model="value"
      :background-color="color"
      dark>
      
      <v-btn>
    <span style=" font-family:'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif;">Raga Identification And Song Generator</span>
   </v-btn>
   
   </v-bottom-navigation>
   <v-stepper alt-labels>
    <v-stepper-header>
      <v-stepper-step step="1" complete >
        Choose A Song
      </v-stepper-step>

      <v-divider></v-divider>

      <v-stepper-step complete step="2">
        Predict
      </v-stepper-step>

      <v-divider></v-divider>

      <v-stepper-step step="3" complete>
        Raga & Notes Are Generated
      </v-stepper-step>
    </v-stepper-header>
  </v-stepper>
  <!--<h3 class="heading" align ="center" >  [[ this.raga ]] </h3>
  <p align ="center" >  [[ this.notes]] </p>-->
  <v-row
    align="center"
    justify="space-around"
  >
  <v-card
    class="mx-auto"
    max-width="400"
  >
    <v-card-text>
      <div>Raga Identification Results</div>
      <p class="text-h4 text--primary">
        [[ this.raga ]]
      </p>
      <p>Notes</p>
      <div class="text--primary">
        [[ this.notes]]
      </div>
    </v-card-text>
    <v-card-actions>
      <v-btn
        text
        color="deep-purple accent-4" 
        v-on:click="addtouser"
      >
        Add to findings
      </v-btn>

    </v-card-actions>
  </v-card>
  <v-card
    class="mx-auto"
    max-width="600"
  >
    <v-card-text>
      <div>Raga Identification Results</div>
      <p >
        <img v-bind:src="'data:image/jpeg;base64,'+img" width="500" height="500"></img>
      </p>
    </v-card-text>
    <v-card-actions>
      

    </v-card-actions>
  </v-card>
  </v-row>
  

    <h5 v-show="user" style="margin-left:10em;"><label>Enter user name:</label> <input v-show="user" type="text" v-model="uname"></h5>
    <br>
    <h5 v-show="user" style="margin-left:10em;"><label>Enter password:</label> <input v-show="user" type="password" v-model="pass"></h5>
    <v-btn
    text
    color="deep-purple accent-4" style="margin-left:10em;" v-show="user" v-on:click="adddet"
      >
        Add to findings
</v-btn>
  
  <button v-on:click="learnMore" v-show="learnMore" class="button button1" >Want to know more?</button>
  <v-btn
  text
  color="deep-purple accent-4" v-on:click="login"  >Login</v-btn>
    </div>
    </v-app>
  </div>
  <br>
  
  <br><br><br><br>
  
  <script>

const gradients = [
  ['#222'],
  ['#42b3f4'],
  ['red', 'orange', 'yellow'],
  ['purple', 'violet'],
  ['#00c6ff', '#F0F', '#FF0'],
  ['#f72047', '#ffd200', '#1feaea'],
]

    new Vue({
  el: '#app',
  delimiters: ['[[', ']]'],
  vuetify: new Vuetify(),
  data: () => ({ value: 1 ,
file1:[],
img:'',
f:"",
filei: false,
width: 2,
raga: '',
uname:'',
pass:'',
    radius: 10,
    padding: 3,
    lineCap: 'round',
    gradient: gradients[5],
    value: [0, 2, 5, 6, 5, 2, 3, 5, 0, 0, 1, 8, 2, 4, 0],
    gradientDirection: 'top',
    gradients,
    fill: false,
    type: 'trend',
    shbutton: false,
    autoLineWidth: false,
    user:false,
    fi :'',
  notes: ''}),

  computed: {
    color () {
      switch (this.value) {
        case 0: return 'indigo darken-4'
        case 1: return 'indigo darken-4'
        case 2: return 'indigo darken-4'
        case 3: return 'indigo darken-4'
        default: return 'indigo darken-4'
      }
    },
   },
  methods:{
    fileInput(e){
        {
          this.file1=  e.target.files[0].name
          this.file1 = this.file1.slice(0, -4)
          this.fi = this.file1
          this.f = "D:/MiniProject/"+this.file1+".mp3"
          if(this.file1)
           { this.filei= true;
            document.getElementById("divModel").scrollIntoView();
           }
          
           fetch('http://127.0.0.1:5000/api/ragagen/'+this.file1, {
                  method: 'POST',
                  headers: {
                    "Content-Type": "application/json", 
                    'Access-Control-Allow-Origin': '*',
                    "Access-Control-Allow-Methods": "DELETE, POST, GET, OPTIONS"
                  },
                  //body:JSON.stringify({'file':this.file1})
                  
              }).then(response => response.json())
              .then(data => {
                this.raga = data
                
                //setTimeout(document.getElementById("Predict").scrollIntoView(),10000);
                
            });
            fetch('http://127.0.0.1:5000/api/notes/'+this.file1, {
                  method: 'POST',
                  headers: {
                    "Content-Type": "application/json", 
                    'Access-Control-Allow-Origin': '*',
                    "Access-Control-Allow-Methods": "DELETE, POST, GET, OPTIONS"
                  },
                  //body:JSON.stringify({'file':this.file1})
                  
              }).then(response => response.json())
              .then(data => {
                this.notes = data
                this.shbutton = true
                //setTimeout(document.getElementById("Predict").scrollIntoView(),10000);
                
            });

            fetch('/api/graph/'+this.file1, 
          {
            method: 'POST',
            headers: {
              "Content-Type": "application/json", 
     
            },
            
        }).then(response => response.json()
        ).then(data=> this.img =data)
        }},
        next(){
          document.getElementById("Predict").scrollIntoView()
        },
        addtouser(){
          this.user = true

        },
        adddet(){
         

              fetch('http://localhost:5000/api/ragadd/'+this.uname, {
                  method: 'POST',
                  headers: {
                    "Content-Type": "application/json", 
                  },
                  body:JSON.stringify({'username':this.uname, 'song_name':this.fi, 'r_name':this.raga,'date':'31-10-2022','notes':this.notes})
                  
              }).then(response => response.json())
              .then(data => {
                
              });
          },

        
        learnMore(){
          window.location.href = '/howitworks'
        },
        login(){
          window.location.href = '/loginpage'
        }
    },
    


})

  </script>
  </html>